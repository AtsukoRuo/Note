# Python速成

[TOC]

## 基础

### 变量

Python是一门动态类型的语言。我们可以在定义变量时，无需指定变量的类型。

~~~python
author = 'AtsukoRuo'				#定义了名为author的变量
print('Hello, {}!'.format(author))
~~~

我们可以在一行中同时操作多个变量：

~~~python
author, reader = 'AtsukoRuo', 'Myokuuu'			# 同时定义两个变量
author, reader = reader, author				    # 同时交换两个变量
~~~



**变量解包（unpacking）**是 Python 里的一种特殊赋值操作，允许我们把一个可迭代对象（比如列表）的所有成员，一次性赋值给多个变量：

~~~python
usernames = ['AtsukoRuo', 'Myokuuu'	]
author, reader = usernames
~~~

可以使用`()`语法，在解包时展开多层嵌套的数据

~~~python
attrs = [1, [2, 3]]
a, (b, c) = attrs
~~~

还可以使用`*`语法，贪婪地获取多个值：

~~~python
data = [1, 2, 3, 4, 5, 6]
a, *b, d = data								# 动态解包
a, b, c = data[1], data[1 : -1], data[-1]	   # 切片赋值
# 上面两个赋值语句都是等价的
# b = [2, 3, 4, 5]
# 在赋值语句中，最多出现一次*表达式
~~~



上面的变量解包操作也可以在任何循环语句里使用：

~~~python
for username, score in [('AtsukoRuo', 10), ('Myokuuu', 20)] :
    print(username)
~~~



### 命名与注解

在命名中，下划线`_`表示一个无意义的占位符

~~~python
# 忽略第一个和最后一个变量之间的所有变量
username, *_, score = data
~~~



有时候，我们不得不说明变量的类型，此时可以使用「**文档注释**」或者「**类型注解**」的方式来显式说明对象的类型。注意Python是动态语言，它无法限定变量的类型。

~~~python
def remove_invalid(items):
    
# 文档注释    
def remove_invalid(items):
    """
    剔除 items 里面无效的元素
    :param items: 待剔除对象
    :type items: 包含整数的列表，[int, ...]
    """
    
# 类型注解
from typing import List   
def remove_invalid2(items: List[int]):
    """剔除 items 里面无效的元素"""
~~~

这两种方式都不能提供静态类型检查，得借助第三方工具 `mypy`来实现检查。



**在计算机科学领域，有一句广为流传的格言：「计算机科学领域只有两件难事：缓存失效和命名。」**。给变量起名主要有两种流派：

- 驼峰命名派 `CamelCase`
- 下划线命名派 `snake_case`

为了让不同开发者写出的代码风格尽量保持统一，Python 制定了官方的编码风格指南：`PEP 8`。其中包含变量的命名规范：

- 对于普通变量，使用蛇形命名法，比如 `max_value`
- 对于常量，采用全大写字母，使用下划线连接，比如`MAX_VALUE`
- 如果变量标记为“仅内部使用”（私有），为其增加下划线前缀，比如`_local_var`
- 类名应该使用驼峰风格（FooClass）、函数应该使用蛇形风格（bar_function）



如何在保证描述性的前提下，让名字尽量简短易读呢？要结合代码情境和上下文

**注释（comment）**是代码非常重要的组成部分。在Python中注释分为两种：

- **代码内注释**，通过输入`#`号来表示
- **接口注释（interface comment）**，通过`"""`注释块来表示

关于注释的几点建议：

- **不要用注释屏蔽代码**。对于不再需要的代码，应该直接把它们删掉。如果有人需要用到这些删掉的代码，那么就让他去Git仓库中找。毕竟版本控制系统就是专门干这个的。

- **不要用注释阐述细节**，而是做概括性总结，起到“代码导读”的作用。

## 基本类型

### 数值类型

在 Python 中，一共存在三种内置数值类型：**整型（int）**、**浮点型（float**）和复数类型**（complex）**：

~~~python
score = 100			# 定义一个整型
temp = 37.2			# 定义一个浮点型
com = 1 + 2j		# 定义一个复数
~~~

Python遵循`IEEE double precision floating-point`标准来实现浮点型的

`int`数值与`float`数值之间的转换：

~~~python
# 使用内置函数int，将浮点数转换为整型
int(temp)

# 使用内置函数float，将整型转换为浮点数
float(score)
~~~

可以使用下划线来分割字面值

~~~python
i = 1_000_000
~~~



在Python中，`bool`类型其实是整型的子类型。它们俩之间可以自动进行类型转换，可以显式调用内置函数`int()`以及`bool()`来完成转换

~~~python
int(True), int(False) 	# (1, 0)
True + 1				# 2
~~~



### 列表

使用`[]`来创建一个列表字面量：

~~~python
numbers = [1, 2, 3]
~~~

使用list()内置函数，将任何一个可迭代对象转换为列表

~~~python
list('foo')		# ['f', 'o', 'o']
~~~

Python的列表既支持**「正向索引」**、也支持**「反向索引」**。而且正向索引是从`0`开始的；反向索引从`-1`开始，表示最后一个元素。

对于列表的遍历获取操作，可以使用列表切片来表述：

~~~python
# 从索引start_index开始，每次迭代索引步进step，直到end_index（不包括end_index）
list[start_index: end_index: step] 	

list[start_index : end_index]		

# step 默认为1
# start_index 默认为0
# end_index 默认为length
~~~





**「列表推导式」**，可以方便的从一个数据序列构建另一个新的数据序列的结构体，格式为：

~~~python
out_exp_res for out_exp in input_list
out_exp_res for out_exp in input_list if condition
~~~

- `out_exp_res`：生成元素的表达式
- `for out_exp in input_list`：迭代 `input_list`，并将 `out_exp` 传入到 `out_exp_res` 表达式中
- `condition`：可以过滤列表中不符合条件的值

~~~python
nubmers = [1, 2, 4, 5, 6]
count = 0
for i in numbers:
    if i % 2 == 0:
        count += 1
        
# 等价于
count = sum(i % 2 == 0 for i in numbers)
~~~



### 字符串

在Python中，字符串是一种序列类型。这意味着你可以对它进行遍历、切片等操作。

~~~python
str = 'Hello World'
~~~



多行字符串

~~~python
s = ("This is the first line of a long string, "
	 "this is the second line")

# 如果字符串出现在函数参数等位置，可以省略一层括号
def main():
logger.info("There is something really bad happened during the process. "
"Please contact your administrator.")
~~~

~~~python
message = """
	Welcome, today's movie list:
		- Jaw (1975)
	- The Shining (1980)
		- Saw (2004)
    """
#	Welcome, today's movie list:
#- Jaw (1975)
#	- The Shining (1980)
#- Saw (2004)
~~~

这种写法会破坏整段代码的缩进视觉效果，此时我们可以使用标准库textwrap中的dedent函数

~~~python
message = dedent("""\
    Welcome, today's movie list:
        - Jaw (1975)
    - The Shining (1980)
        - Saw (2004)""")


#Welcome, today's movie list:
#	- Jaw (1975)
#	- The Shining (1980)
#	- Saw (2004)
~~~

这和Java中的字符串块类似



**字符串格式化：**

- **C 语言风格**

  ~~~python
  username, score = 'piglei', 100
  
  print("Hello %s", %username)
  print('Welcome %s, your score is %d' % (username, score))
  ~~~

  占位符的语法如下：

  ~~~python
  %[(name)][flags][width][.precison]type
  ~~~

  - `%`:它标记占位符的开始。

  - | type  | 说明                                        |
    | ----- | ------------------------------------------- |
    | `s`   | 字符串（使用`str()`方法转换任何Python对象） |
    | `d`   | 十进制整数                                  |
    | `f`   | 十进制浮点数(小数), 自动保留六位小数        |
    | `...` |                                             |

  - `precison`：精度

- **新式字符串格式化（str.format）方式**

  ~~~python
  print('Welcome {}, your score is {:d}'.format(username, score))
  ~~~

  格式化的语法

  ~~~python
  {[index][:[[fill]align][sign][#][0][width][grouping_option][.precision][type]]}
  ~~~

  - `index`：支持用位置参数来格式化字符串，实现对参数的重复使用。这个时f-string所不支持的特性

    ~~~python
    username, score = 'piglei', 100
    print('{0}: name={0} score={1:d}'.format(username, score))
    ~~~

  - `fill`：填充时所用到的字符

    ~~~python
    print('{0:*^20}'.format('hello python'))
    # ****hello python****
    ~~~

  - `align`：对齐方式。配合着`width`使用

    | 符号 |   含义   |
    | :--: | :------: |
    |  <   |  左对齐  |
    |  >   |  右对齐  |
    |  ^   | 居中对齐 |

  - `precison`：精度

  

- **f-string 字符串字面量格式化表达式**

  ~~~python
  print(f'Welcome {username}, your score is {score:d}')
  ~~~

  

  



**字符串的常用操作**

- **逆转**

  ~~~python
  str[::-1]
  ''.join(reversed(str))
  
  # 上面两个是等价的
  # 注意reversed 会返回一个可迭代对象，通过字符串的 .join 方法可以将它转换为字符串
  ~~~

- **拼接**

  ~~~python
  '$'.join(["hello", "world"])
  # hello$world
  ~~~

  `join`函数接受一个可迭代对象，然后用对象来做分隔符。

- **切片**

  常用切片函数有两个`split()`、`partition()`

  ~~~python
  str.split(' ', 1 );
  ~~~

  第一个参数是分隔符（默认为空白符），第二个参数是最大分割次数（默认为-1，即分割所有）。返回一个列表

  

  ~~~python
  str.partition(splitor)
  ~~~

  splitor指定分隔符，它返回一个3元组，第一个为分隔符左边的子串，第二个为分隔符本身，第三个为分隔符右边的子串。

  ~~~python
  str = "www.runoob.com"
   
  print str.partition(".")		
  # ('www', '.', 'runoob.com')
  
  # 匹配到多个分隔符，第一个开始分割
  # 若没有匹配到分割符，那么元组的第二个、第三个元素都为空字符串''
  ~~~

  

  此外，还可以使用`+=`或者`append()`来追加字符串。

  

- 替换

  ~~~
  str.translate(table);
  ~~~

  table就是一张映射表，从`maketrans()`方法获取
  ~~~python
  import string
  intab = "aeiou"
  outtab = "12345"
  str = "this is string example....wow!!!"
  table = str.maketrans(intab, outtab)
  print(str.translate(table))
  # th3s 3s str3ng 2x1mpl2....w4w!!!
  ~~~

- 编码与解码

  ~~~python
  import string
  str = "Hello World"
  s = str.encode('gb2312')
  print(s.decode('UTF-8'))
  ~~~

  

## 容器类型

在 Python 中，最常见的内置容器类型有四种：

- **列表**：用来存放多个同类对象

- **元组**：和列表非常类似，但它不能被修改

- **字典**：存放的是键值对

- **集合**：

### 列表



## 分支

## 异常

## 循环

## 函数

## 装饰器



## 类

