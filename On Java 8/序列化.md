# 序列化

[TOC]

## 要解决的问题

- **序列化**：把Java对象转换为字节序列。
- **反序列化**：把字节序列恢复为原先的Java对象。



在很多场景下都有这样一个需求：当程序退出后，对象的状态仍然保留相关信息。并在下次启动程序后，可以将对象恢复到原先的状态。我们可以通过将相关状态信息写入文件或数据库来满足此需求。一般编程语言也会提供序列化机制，来帮助我们处理其中的细节。



此外，**远程方法调用**（remote method invocation, RMI）机制也可以用序列化来实现。

## Serializable

Java的**对象序列化**（object serialization）机制会接受实现了`Serializable`接口的任意对象，并将其转换成一个字节序列。其中`Serializable`是一个标签接口，没有方法

Java的对象序列化使用了一种遍历对象网络的优化算法，来跟踪该对象所包含的所有引用并序列化。

## 安全性

几乎从诞生之日起，Java就提供了对象序列化功能。但直到最近Java团队才承认，Java序列化在设计上存在危险的缺陷，并且一直是这门语言里严重安全漏洞的来源。

对不受信任的数据进行反序列化操作，这根本就是一个危险的行为。在许多典型的场景里，流的字节数据来源于未知的、不受信任的或未经验证的客户端。通过仔细地构建流数据，攻击者可以不怀好意地执行任意类中的代码。如果对象构建时会改变状态或调用其他操作，则这些操作可能会危及数据的完整性。

出于安全目的，不应该再基于此来实现新系统，而是应该学习Java特性增强提案（Java Enhancement Proposal, JEP）415的内容——过滤器工厂。

