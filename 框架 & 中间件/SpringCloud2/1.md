# 概述和基础



分布式的目的

- 高可用
- 可伸缩性
- 高性能



分布式的切分方法：

- 水平切分：将同一个系统部署到多台机器上

- 垂直切分：把系统按照业务维度进行了切分。
  - 系统被切分成多个模块，每个模块尽可能地独立，做到高内聚低耦合，从而降低了开发难度
  - 增加了系统之间的协作
  - 数据一致性问题



八大谬论：

- 网络是可靠的。
- 网络是没有延迟的。
- 带宽是无限的。
- 网络是安全的
- 网络拓扑不会改变。
- 肯定至少有一个（在值班的）管理员
- 传输开销为零
- 网络是同质的

网络的不可靠性（如丢包、延时等）、拓扑结构的差异和传输速率大小等因素对分布式系统都存在很多的限制。难点在于如何让多个节点之间保持一致性



CAP 原则：

- 强一致性（Consistency）
- 可用性（Availability）
- 分区容忍性（Partition tolerance）



BASE 理论：

- BA（Basically Available，基本可用）
- S（Soft State，软状态）
- E（Eventual Consistency，最终一致性）



BASE 理论中地一致性划分：

- **强一致性**：当用户完成数据更新操作之后，任何后续线程或者其他节点都能访问到最新值
- **弱一致性**：当用户完成数据更新操作之后，并不能保证后续线程或者其他节点马上访问到最新值



微服务的风格

- 组件化和服务
- 围绕业务功能组织团队
- 是产品而不是项目
- 强化终端及弱化通道
- 分散治理
- 分散数据管理
- 基础设施自动化
- 容错性设计
- 设计改进



从微服务的风格来看，它并不是为了克服所有的分布式系统的缺陷而设计的，而是为了追求更高可用性和简易性。但与此同时，也弱化了其一致性

Spring Cloud容纳了很多分布式开发的组件

- Spring Cloud Config：配置管理，允许被集中化放到远程服务器中。
- Spring Cloud Bus：分布式事件、消息总线、用于集群（如配置发生变化）中传播事件状态
- Netflix Eureka：服务治理中心，它提供微服务的治理，包括微服务的注册和发现
- Netflix Hystrix：断路器，在某个组件因为某些原因无法响应或者响应超时之际进行熔断，以避免其他微服务调用该组件造成大量线程积压。它提供了更为强大的容错能力
- Netflix Zuul：API网关，它可以拦截Spring Cloud的请求，提供动态路由功能。它还可以限流，保护微服务持续可用，还可以通过过滤器提供验证安全
- Spring Cloud Security：它是基于Spring Security的，可以给微服务提供安全控制
- Spring Cloud Sleuth：它是一个日志收集工具包，可以提供分布式追踪的功能
- Spring Cloud Stream：分布式数据流操作，它封装了关于Redis、RabbitMQ、Kafka等数据流的开发工具
- Netflix Ribbon：提供客户端的负载均衡。它提供了多种负载均衡的方案
- OpenFeign：它是一个声明式的调用方案，可以屏蔽REST风格的代码调用，而采用接口声明方式调用，这样就可以有效减少不必要的代码，进而提高代码的可读性
- ...

Spring Cloud的未来趋势是去Netflix组件